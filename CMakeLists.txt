# We require 2.8.4 because earlier releases had a bug
# with invalid HEADER_FILE_ONLY behavior in MSVC 2010.
cmake_minimum_required(VERSION 2.8.4)
project(Panda3D)
enable_testing()

# Add generic modules to cmake module path,
# and add Panda3D specific modules to cmake module path
set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${CMAKE_SOURCE_DIR}/cmake/modules/")
set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${CMAKE_SOURCE_DIR}/cmake/macros/")

# Include global modules
include(AutoInclude)        # Implements automatic include_directories finding
include(AddBisonTarget)     # Defines add_bison_target function
include(CompositeSources)   # Defines composite_sources function
include(PackageConfig)      # Defines package_option AND target_use_packages
include(Interrogate)        # Defines target_interrogate AND add_python_module

# Add the include path for source and header files generated by CMake
include_directories("${CMAKE_BINARY_DIR}")

# Configure Panda3D
include(dtool/PandaVersion.cmake)
include(dtool/Package.cmake)
include(dtool/Config.cmake)

# Determine which trees to build.
option(BUILD_DTOOL "Build the dtool source tree." ON)
option(BUILD_PANDA "Build the panda source tree." ON)

# Include Panda3D packages
if(BUILD_DTOOL)
  add_subdirectory(dtool)
endif()

if(BUILD_PANDA)
  add_subdirectory(panda)
endif()
